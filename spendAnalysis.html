<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spend Analysis - TekSA</title>
    <link rel="stylesheet" href="main.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .header {
            background-color: #3498db;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .navbar {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            background-color: #2980B9;
            padding: 10px;
        }
        .navbar a {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            background-color: #3498DB;
            border-radius: 4px;
            margin: 5px;
        }
        .navbar a:hover {
            background-color: #1B4F72;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h2, h3 {
            color: #2980B9;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #2980B9;
            color: white;
        }
        .summary-section {
            margin-top: 20px;
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
        }
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
            color: #2980B9;
        }
        .download-button {
            display: block;
            width: fit-content;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #2980B9;
            color: white;
            font-weight: bold;
            text-align: center;
            text-decoration: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* Responsive styling */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                width: 90%;
            }
            .navbar a {
                padding: 8px 10px;
                font-size: 14px;
            }
            .summary-item {
                font-size: 14px;
            }
            table {
                font-size: 14px;
            }
            .download-button {
                font-size: 14px;
                padding: 10px;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 15px;
                font-size: 18px;
            }
            .navbar a {
                padding: 8px;
                font-size: 12px;
            }
            h2, h3 {
                font-size: 16px;
            }
            th, td {
                padding: 8px;
                font-size: 12px;
            }
            .summary-item {
                flex-direction: column;
                align-items: flex-start;
                font-size: 12px;
            }
            .download-button {
                font-size: 12px;
                padding: 8px;
            }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>Spend Analysis - TekSA</h1>
        <p>Analyze and review procurement expenditures across suppliers and categories</p>
    </div>

    <div class="navbar">
        <a href="dashboardINT.html">Dashboard</a>
        <a href="inventory.html">Inventory</a>
        <a href="finance.html">Finance</a>
        <a href="hr.html">HR</a>
        <a href="procurement.html">Procurement</a>
        <a href="production.html">Production</a>
        <a href="inventoryReports.html">Reports</a>
    </div>

    <div class="container">
        <h2>Spend Analysis Report</h2>

        <div class="summary-section">
            <div class="summary-item">
                <span>Total Spend:</span>
                <span>ZAR 2,500,000</span>
            </div>
            <div class="summary-item">
                <span>Top Supplier:</span>
                <span>ABC Supplies Ltd.</span>
            </div>
            <div class="summary-item">
                <span>Most Purchased Category:</span>
                <span>Raw Materials</span>
            </div>
        </div>

        <h3>Spend by Supplier</h3>
        <table>
            <tr>
                <th>Supplier</th>
                <th>Total Spend (ZAR)</th>
                <th>Percentage of Total Spend</th>
            </tr>
            <tr>
                <td>ABC Supplies Ltd.</td>
                <td>ZAR 1,200,000</td>
                <td>48%</td>
            </tr>
            <tr>
                <td>XYZ Manufacturing Co.</td>
                <td>ZAR 800,000</td>
                <td>32%</td>
            </tr>
            <tr>
                <td>Global Materials Inc.</td>
                <td>ZAR 500,000</td>
                <td>20%</td>
            </tr>
        </table>

        <h3>Spend by Category</h3>
        <table>
            <tr>
                <th>Category</th>
                <th>Total Spend (ZAR)</th>
                <th>Percentage of Total Spend</th>
            </tr>
            <tr>
                <td>Raw Materials</td>
                <td>ZAR 1,500,000</td>
                <td>60%</td>
            </tr>
            <tr>
                <td>Office Supplies</td>
                <td>ZAR 500,000</td>
                <td>20%</td>
            </tr>
            <tr>
                <td>IT Equipment</td>
                <td>ZAR 500,000</td>
                <td>20%</td>
            </tr>
        </table>

        <a class="download-button" onclick="downloadCSV()">Download Report as CSV</a>
    </div>

    <script>
        function downloadCSV() {
            const rows = [
                ["Supplier", "Total Spend (ZAR)", "Percentage of Total Spend"],
                ["ABC Supplies Ltd.", "1200000", "48%"],
                ["XYZ Manufacturing Co.", "800000", "32%"],
                ["Global Materials Inc.", "500000", "20%"],
                [],
                ["Category", "Total Spend (ZAR)", "Percentage of Total Spend"],
                ["Raw Materials", "1500000", "60%"],
                ["Office Supplies", "500000", "20%"],
                ["IT Equipment", "500000", "20%"]
            ];

            let csvContent = "data:text/csv;charset=utf-8," 
                + rows.map(e => e.join(",")).join("\n");

            const link = document.createElement("a");
            link.setAttribute("href", encodeURI(csvContent));
            link.setAttribute("download", "spend_analysis_report.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>

</body>
</html>
